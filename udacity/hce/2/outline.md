
# Course 2 Outline: Private Cloud Automation
- Objectives: [2/lesson_learning_objectives](2/lesson_learning_objectives.md)
- [*Udacity Course 2 Folder*](https://drive.google.com/drive/folders/1C3nNTHU8GKmpV1GvlpQoFze5Y2eS_Rjm):
  - [Project Proposal](https://docs.google.com/document/d/1Y0ulqpMF6Atod_yBlaUwULdtIDDbKQWYHp8Rk1KUx6Y/edit) = Private cloud automation: three tier web app
  - [Project Deliverables](https://docs.google.com/document/d/1p3lg1ohIPsjmHMV2cDB_zMxa8JsYBV4W6v-kHI4X74s/edit)
  - Course Outline G.sheet and Lesson G.Docs
---
0.  Lesson 0: Welcome to Course 2
  - Concept: Meet your instructor: Mark Lavi
    - https://docs.google.com/document/d/1nBgHS6b201Z3g11suFH8DZYjH9T94flFgOwqPmgl7gs/edit#heading=h.yafbfdzd3lst
  - Concept: Course 2 overview:
    - Multi-cluster, scale out control plane = a private cloud
    - Automation is the key to self-service
    - From VM IaaS monolith to the PaaS scalable web application to SaaS life cycle operations

1.  Lesson 1: Managing multiple cluster and workload resources
  - Concept: Lesson 1 overview and objectives
    - Big Picture: intro, text summary, image, vocab, links/references
    - Developing your Inspiration:
    - Map business requirements to governance facilities in Prism Central: RBAC, Projects, and Providers
  - Concept: Prism Central
    - Identify the difference between Prism Element and Prism Central and capacity plan enabling Prism Central and Calm automation.
    - Prism Element control plane for a single Nutanix cluster
    - PC = Scale out control plane for multiple Nutanix clusters, cluster by hypervisor/hardware provider
    - SIMULATION/LAB: PC deployment sizing choices and discussion
    - Concept: warnings and alert logs for cluster resource management
    - Note that we will skip advanced PC workload management facilities: AIOps, sizer runway, etc.
  - Quiz L1Q1: PE vs PC
    - Review answer
  - Concept: Prism Central concepts for governance
      - Concept: Course 1 recap: Governance and business needs: Model business governance requirements using identity management and role based access controls with project resource quotas and provider show back costs.
      - Concept: ECA Pill? PC Identity management
      - Concept: [PC RBAC: Role Based Access Control](pills/ECA-3_0-Course-Guide_ditamap/eca/eca_5-15/for-alpha/eca-5-10-12-prism-central/topics/Prism_Central_Overview_2.html)
      - Concept: ECA Pill? PC Categories:
        - Manage VMs and disk images with categories.
      - Concept: ECA Pill? PC Projects:
          - Users and Roles: granular RBAC levels
          - AHV resource quota: CPU, memory, storage
      - Concept: ECA Pill? AHV VM Image Management, categories, and clusters
      - SIMULATION/LAB: upload and categorize a CentOS 7 cloud image (see Course 2: Project Deliverables)
      - SIMULATION/LAB: create a PC project (not Calm project) with an AHV simple quota
  - Quiz L1Q2: Map business requirement scenario to PC concepts
      - Review answer
  - Concept: [Calm enablement choices for capacity planning](https://nutanix.handsonworkshops.com/workshops/4202ba14-b4db-4cc4-ab73-2134e70b518e/view/calm_enable/calm_enable/)
  - SIMULATION/LAB: Calm enablement (abbreviated video?)
  - Lesson 1 Review: we learned to do 1,2,3

2. Lesson 2: Calm automation for application lifecycle management
  - Concept: Lesson Learning Objectives:
    - Identify Calm automation and orchestration benefits
    - Publish pre-seeded blueprints to the marketplace for customer self-service, on-demand VM IaaS workloads.
    - Complete a deployment, audit, and deprovision for for VM IaaS
  - Concept: Calm Overview: automation for application lifecycle management
    - Big Picture: intro, text summary, image, vocab, links/references
    - Developing your Inspiration:
      - [Calm basics](https://nutanix.handsonworkshops.com/workshops/4202ba14-b4db-4cc4-ab73-2134e70b518e/view/calm_basics/basics/)
      -   Demo: Calm navigation, self-service applications on-demand under governance
      -   [*https://github.com/mlavi/calmbootcamp/blob/master/what\_is\_calm/what\_is\_calm.rst*](/what_is_calm/what_is_calm.rst)
  - Quiz: Calm automation does...
      -   infra only
      -   apps only
      -   both (correct)
      -   Review answer
  - Concept: VM IaaS for self-service IT
    - Most important first step for a private cloud
    - Concept: Linux OS, CentOS 7 for a fast, license free base OS
      - Discuss why Linux (vs Windows license), rapid provisioning time, Docker container native
      - Factoid: Microsoft Azure rapidly found over 50% of their workloads were Linux (need to find reference)
      - I edited down answers from these sources:
        - https://en.wikipedia.org/wiki/Linux
        - What is Linux? https://www.kernel.org/linux.html
        - https://en.wikipedia.org/wiki/CentOS
        - https://wiki.centos.org/FAQ/General#What_is_CentOS_Linux.3F
      - Linux is a family of open source Unix-like operating systems based on the Linux kernel, first released in 1991, by Linus Torvalds. Linux is typically packaged in a Linux distribution, which include the kernel and supporting system software and libraries, many of which are provided by the GNU Project. Linux has the largest installed base of all general-purpose operating systems, it is the kernel of Android and Chrome OS for mobile phones, tablets, and laptops. Linux is the leading operating system on servers (over 96.4% of the top 1 million web servers' operating systems are Linux) and is the only OS used on TOP500 supercomputers. Linux also runs on embedded systems, which includes routers, smart home technology, televisions, automobiles.
      - CentOS, from Community Enterprise Operating System is a Linux distribution that provides a free, community-supported computing platform functionally compatible with its upstream source, Red Hat Enterprise Linux (RHEL) and uses open source licensing.
    - Concept: SSH keypairs for secure access to Linux VMs
      - SSH key password background (vs static password)
      - SSH Pill sources: ssh-keygen -m PEM -t rsa -f keyname -C comment
      - https://mlavi.github.io/post/ssh-key-authentication/
      - https://portal.nutanix.com/page/documents/details/?targetId=Nutanix-Calm-Admin-Operations-Guide-v3_0%3Anuc-ssh-keys-for-linux-and-windows.html
      - LAB/EXERCISE/SIMULATION: perhaps U-lab Ubuntu 16.04+?:
        - *TBD: Create and save "udacity" SSH passphrase-less key pair to student workspace?*
    - Concept: Cloud-init for basic, dynamic, secure configuration
      - cloud-init is YAML, space is critical
      - trouble shooting can be difficult and implementations can vary by OS version
      - Calm can also provision a Windows VMs with SysPrep, the analog to cloud-init.
  - Concept: Calm governance consists of providers, projects, RBAC, and the Marketplace workflow publishing process
  - Concept: Calm \> Settings \> Providers
      - When PC is deployed on AHV, the host cluster is automatically configured out of the box.
      - Optional: Show Back Costs for VM vCPU, memory, storage dimensions
      - Calm Providers can add multiple clouds and hypervisors, just requires credentials and network access from Calm+PC.
      - Calm Providers can also use Kubernetes, but we'll use the AHV VM provider in course 2.
      - In course 3, we will add a public cloud provider to accomplish a hybrid cloud application deployment.
  - Concept: Calm \> Projects
      - Extended from PC projects
      - Includes Calm Roles: RBAC levels of project admin, developer, consumer, operator (slide)
  - Quiz: match the role to privilege
      a.  Review answer
  - LAB/SIMULATION: create your first Calm (not PC) project.
    - Simulation is safer versus pre-create $STUDENTID-C2L2-demo project with $STUDENTID as a Project Admin to configure remaining properties.
      a.  Create project \$STUDENTID-project
      b.  Add yourself as a project administrator
      c.  Add AHV cluster, do not use quotas.
      d.  Save and confirm your project
      e.  Review exercise: you created a project for governance
  - Concept: Calm Projects, part 2
          a.  Provider Quotas
          b.  Environments
            - Add SSH credential: superuser, upload your SSH passphraseless private key
              - L2 reuse your SSH key from your workspace
            - Add Nutanix tab, skip Windows, turn down Linux VM config:
            - Keep name, 1/1/1
            - cloud-init with @@{superuser.publickey}@@ and @@{INSTANCE_PUBLIC_KEY}@@
              - These are Calm macros, we'll discuss in detail later in the lesson.
            - Disk, clone from img service, CentOS 7 (preloaded on cluster), bootable
            - NIC 1: VLAN, Dynamic IP
            - Check login with superuser credential
            - Save
  - LAB/SIMULATION: Configure a project environment for a basic Linux VM with cloud-init and SSH key credentials
  - Concept: Nutanix Marketplace
      -   Blueprint Publishing workflow
      -   Self service: Nutanix Marketplace
      -   Demo video: Project summary of my cluster
  - LAB/EXERCISE: publish a marketplace blueprint to a student project, launch blueprint, audit application, delete application
  - *Concept: Best practices for Blueprint standards:
    - Reference: PracDev Template - Nutanix Calm Design.docx ask Stephane.B and Jesse Gonzalez for permission to quote or reference!
    - Review that we introduce macro pill sooner
    - Parcel out to each section: credential*
  - Concept: Review lesson learnings:
      -   Calm overview, governance, self-service life cycle management of an existing blueprint with auditing

3.  Lesson 3: Create and publish your first Calm single-VM blueprint to achieve self-service VM IaaS
  - Concept: Learning objectives:
      1. Create a single-VM blueprint using cloud-init and SSH credentials
      2. Publish a marketplace blueprint for customer self-service, on-demand VM IaaS workloads.
      3. Test a deployment, audit, and deprovision for VM IaaS
    - Big Picture: intro, text summary, image, vocab, links/references
    - Developing your Inspiration:
  - Concept: Calm Overview with the Marketplace
    - Once logged into Prism Central, the marketplace provides end-user self-service to published blueprints, availability is determined by user's project(s) and their role.
    - We'll demonstrate a basic blueprint life cycle by publishing a pre-seeded database blueprint to the marketplace and launching the blueprint with an application name 'Udacity-demo1'. Then we'll manage and delete 'Udacity-demo1' application of the database blueprint.
      - i.e. An application is a blueprint deployment or instantiation.
    - *Demo Video:*
      - Calm > Marketplace Manager: publish a pre-seeded Marketplace MongoDB (single) blueprint
        - specify a project containing a Linux environment
      - Calm > Marketplace: launch blueprint
        - choose your project
        - name your application deployment: Udacity-demo1
        - choose the AHV application profile, note that others are ghosted out because not part of the project
        - examine the configuration tabs: VM, credential, etc.
        - provide the credential private key and the INSTANCE_PUBLIC_KEY public key
        - Launch, note that we are advanced to Calm > Applications > Udacity-demo1
        - Review provisioning overview, Manage > Create view, then Audit tab > Create
        - Calm Projects > Review project use to use VMs/cost consumption
        - Turn down tasks and display/pop-out logs to show real-time progress
          - Logs can be reviewed to troubleshoot problems and downloaded (with the download icon) for forensics
        - Wait for Create action to complete, review the Services tab to show the VM properties
        - Delete the application to complete the lifecycle.
  - Concept: Calm Blueprint Overview
    - The demo showed us the self-service aspect of consuming a blueprint from the marketplace.
    - Blueprints model the life cycle of infrastructure, applications, governance, and operations.
      - The simplest blueprints model:
        - a pet VM for IaaS
        - operations: create and delete actions
        - governed by:
          - provisioning with a single provider, set by the project upon blueprint creation
          - static and run-time VM configuration
      - The simplest blueprint life cycle: development (and troubleshooting), launch, manage, delete.
      - We will expand on more blueprint concepts after the Single-VM blueprint exercise to build towards PaaS and SaaS-like models.
    - Concept: (un)publish to Marketplace
    - Concept: Delete a blueprint.
    - Concept: Calm > Blueprint: directory, searching by: status and name
      - Status: deleted is how you can reclaim blueprints in your projects
    - Concept: Launch the blueprint
      - Blueprints can launched from the single VM wizard, multi-VM blueprint editor, Calm > Blueprint, or Calm > Marketplace.
        - Outside Calm, blueprints can be launched via API and the Calm DSL CLI.
      - Launch requires us to name the application deployment
        - One can review the static values and configure run-time values
        - Click Launch button to be taken to Applications to manage the life cycle
    - Concept: Audit and Delete the application deployment to complete the lifecycle.
  - Concept: Calm Single-VM blueprint
    - The Single-VM blueprint encapsulates the infrastructure and configuration of a VM on a project's enabled providers.
    - This is a wizard driven experience, which makes VM IaaS simple, but with a smaller set of Calm capabilities than the multi-VM blueprint.
    - All Calm blueprints are created in a project, requiring a Developer role or higher in the project.
    - We'll leverage the Project environment to cut down on copy and paste.
  - EXERCISE/LAB:
      - Navigate to blueprints > + Create Blueprint > Single VM Blueprint
      - Blueprint Settings, Step 1: name "singlevm-centos7", choose your student project, choose "VM Details >" button
      - VM Details, Step 2:
        - "Clone from environment"
        - Review everything
        - Choose "VM Configuration >" button
      - VM Configuration, Step 3:
        - Review and keep everything, but set NIC 1 to dynamic IP
          - *TBD: Calm 3.0 bug?*
        - Choose "Advanced Options >" button
        - Review advance options
        - Note Actions (optional), we'll address all of these other optional features later in lesson
        - Choose "Credentials" button
        - Recreate your passphrase-less SSH credential with credential name "superuser", username "udacity", upload private key
          - *TBD: Calm 3.0 bug?*
      - Choose the "App variables (0)" button, next to the "Save" button.
        - "+ Add Variable" button
        - Name: INSTANCE_PUBLIC_KEY (matches cloud-init macro from the student project environment)
        - String, Value: paste your public key, (Note: this is redundant, but this)
        - Show additional options: Mark this Variable mandatory
          - *TBD: Validate with RE?*
        - "Done" button
        - "Save" button
      - Note that estimated cost comes from provider settings.
      - Saving causes the model to be validated
      - *TBD: Things to look out for to troubleshoot problems?*
      - Launch the blueprint, name it: c2l3-single
        - Launch requires us to name the application deployment
        - One can review the static values and configure run-time values
          - Populate the INSTANCE_PUBLIC_KEY variable
          - Populate the credential private key
          - Set the NIC VLAN for the VM(s)
        - Click Launch button to be taken to Applications to manage the life cycle
          - Review the overview, manage, audit, and then actions area.
        - Review the Calm > Projects to see your resource consumption
        - Return to Calm > Applications > c2l3-single overview and then delete the application.
      - Review exercise: you managed your first application from creation to deletion with self-service
      - Quiz: Calm blueprints
          - Substrate vs. service model bottoms up/top down?
          - Visio
          - TBD
          - Review answer

- Lesson 4
  - Concept: Learning objectives:
    1. Identify multiple service blueprint life cycle: development, launch, audit, publish, clone.
    2. Create a Calm blueprint to automate the configuration, deployment, restarting of a web server on a Linux VM leveraging the Task Library.
    2. Configuration and deployment of a web server with a sample PHP web application, from the LAMP stack.
    - Big Picture: intro, text summary, image, vocab, links/references
    - Developing your Inspiration:
  - Concept: Calm Blueprint Life cycle: Clone blueprint within a project.
    - What is dropped inside the same project? Credentials + secrets.
    - What is dropped outside the project? Potentially cluster, network, image.
  - Concept: Calm Blueprint Life cycle: Download and Upload blueprints
    - Blueprints are JSON format and recommended to store in source code control systems.
    - Secrets and credentials are emptied when downloading a blueprint unless a password is provided to encrypt the blueprint and preserve these values.
    - You can upload a JSON blueprint into Calm, there are many example blueprints at:
      - https://github.com/nutanix/blueprints
    - Blueprints can be also be made with Python using the Calm Domain Specific Language:
      - This requires basic Python skills and outside the scope of this course, reference: https://github.com/nutanix/calm-dsl/
  - Concept: Calm Multi-VM Blueprint development with the visual editor
    - After completing the simplest single-VM IaaS blueprint, we'll configure capabilities for multiple VMs, infrastructure providers, and operations the blueprint to can represent the entire application life cycle model, to address PaaS and SaaS use cases. These multiple requirements of infrastructure, application, operations, and governance are contained in the blueprint for highly automated and reusable workloads.
    - Blueprint name best practice: lowercase, use dashes not spaces for descriptive word limiters.
    - Upload/download and save to revision control.
    - Use the Markdown in the description to document:
      - authors
      - version
      - assumptions/hard-coded pets
      - run-time inputs for launch: defaults, etc.
      - document custom actions
      - URL/repo link for more documentation
  - Concept: Calm Services and Substrates
    - Substrates map from Calm > Settings > Providers that are further configured in a Project, potentially with resource allow lists and quotas.
    - Properties of a VM are static unless you delegate runtime property and/or set as a macro.
    - Service name best practice: InterCap/Pascal convention/CamelCase: no spaces. e.g.: Mysql or DbMySql
    - VM name best practice: typically an IT naming convention, which also implies hostname and DNS/service discovery, but in lieu of any standard, use service best name practice and append a service type suffix: Vm (this will lay the groundwork for K8s pods in the future), e.g.: MysqlVm
    - Credential name best practice: lowercase, no spaces. Ideal for name to represent the function, role, or facility used. e.g.: domain_admin, local_admin, dba, webteam, web, backups
    - In course 2, we'll focus on VM services from the AHV provider, and in course 3, we'll add a public cloud provider for VM services to accomplish a hybrid cloud deployment.
    - References:
      - [Calm Glossary](../../../appendix/glossary.rst) when needed for students
      - *Calm in Action, Calm Automation playlists?*
      - [Service Documentation](https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Calm-Admin-Operations-Guide-v3_0%3Anuc-components-service-introduction-c.html)
  - Concept: Calm Macros Pill
    - Calm Macros are variables using the @@{name}@@ syntax, they allow dynamic configuration of values during blueprint execution.
    - Macros can be used in Service properties and in Tasks
    - Macros are global, but can be defined in the application profile and on a service
    - Macros best practice: lowercase, use _ to delimit descriptive words.
    - Add references:
      - [Calm Glossary](../../../appendix/glossary.rst)
      - *Calm in Action, Calm Automation playlists?*
      - [Reference Documentation with more detail](https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Calm-Admin-Operations-Guide-v3_0%3Anuc-components-macros-overview-c.html)
  - Concept: Walthrough/demo of C2L4-Lab1
    - We are recreating single VM IaaS blueprint in two stages to progressively introduce advanced Calm concepts.
  - Exercise/Lab: C2L4-Lab1
    - Create a new blueprint in your student project, name it: C2L4-VM
    - Add your SSH credential to superuser
    - Add an AHV VM, clone from project environment, check cloud-init, allow CPU to be changed at launch, set NIC
    - Add a category, Env:Development
    - Save blueprint, troubleshoot any validation problems.
    - Launch blueprint, verify SSH key works via web terminal, delete application.
    - Save your blueprint to the workspace.
    - Clone your blueprint to C2L4-Web, we'll use the clone for the start of the next exercise.
  - Concept: Application Profiles Pill
    - Every blueprint has a default profile, it can be thought of a base layer of the blueprint.
      - The default profile was used in the single-VM blueprint, but it was invisible to the user.
      - If needed, the default profile can be renamed for a better description for operators.
    - Additional application profiles provide the operator role (or higher) deployment choices when using an application deployment.
      - This increases blueprint reuse (of actions and governance) instead of making separate blueprints for each permutation of deployment.
      - Use application profiles to reduce the amount of delegated run-time properties: less choice reduces complexity and increases productivity: less is more!
    - Application Profile best practice: make this as simple and user-friendly as possible, use nouns that reflect the audience use case/jargon. Capitalized noun, ideally without spaces. Make application profiles a set of mutually exclusive choices. Avoid pets when possible! e.g.:
      - Production, Staging, UserAcceptanceTesting, Test, QualityAssurance, Development, ContinousIntegration
      - Public, Private, Hybrid
      - AHV, AWS, Azure, GCP, ESX, K8s
      - DataCenter1, BranchOffice9, Colo3, DisasterRecoveryWest, DisasterRecoveryCentral
      - Small, Medium, Large, Jumbo
      - Titanium, Gold, Silver, Bronze
    - Example use of profile for operator choice:
      - Recommended configurations, such as capacity size: small versus medium versus large resource consumption for different needs.
      - Limited to full configuration delegation with run-time property overrides.
      - Different infrastructure providers for a public, private, and/or hybrid deployment.
      - Any combination of the above.
      - Add reference: [Calm Glossary](../../../appendix/glossary.rst) when needed for students
      - *Calm in Action, Calm Automation playlists?*
  - Concept: Calm Actions1
    - The default application profile contains several actions.
    - Actions are comprised of one or more tasks, which appear as gray ovals on a service.
      - Tasks have a few types: Shell, Eval, HTTP, Pause.
      - Tasks are executed sequentially on each service.
      - All services execute their actions and tasks in parallel unless a dependency is created to control orchestration, allowing operational control across the entire application.
      - Let's review the actions, the simplest life cycle actions would be for IaaS:
        - Create and Delete:
          - Create: invoked upon a blueprint launch, covers all services to allow orchestration, provisions and configures the service in the provider.
          - Delete: deprovision the services with the provider.
        - Start, Stop, and Restart:
          - These actions are available to operate the entire deployment, but in the simplest Blueprints, these typically remain empty until populated with tasks.
          - In addition, when the Create action finishes it will immediately call the Start action on each service.
          - Correspondingly, the Delete action will call and complete the Stop action before performing it's tasks on each service.
  - Concept: Shell Task Pill
    - During multi-VM blueprint development, you can test a Shell task.
    - There are additional Calm task types (Powershell (for Windows VMs, the analog to SSH), eScript, HTTP, Pause, Eval), but we will not use them in this nanodegree.
  - Concept: Calm Task Library
    - Tasks can be browsed and loaded from or saved to the task library, to promote reuse across blueprints.
    - Tasks from the library are copied into blueprint, they do not update when the library changes, which keep the blueprints safe.
  - Quiz: why task library?
      - Cut down on typing and human error
      - Foster reuse
      - Scope?
      - TBD: Review answer
  - Concept: Calm Multi-VM web server blueprint: Part 2
      - Our goal is to deploy a workload on-prem for a self-service web server for developers.
      - One of the most popular web server stack is LAMP.
      - We already know L, we will address A and P in this lesson.
      - We will address M and load balancer in lesson 5.
  - Concept: Apache web server pill:
    - Why Apache? One of the oldest, but also most widely used web servers.
      - Open source: so distributed with nearly Linux OS, and easy to install.
      - Often compared to other web server software: nginx, IIS on Windows
      - *too much detail? Even with scale-out microservice container architecture, may not be the ideal overhead (e.g. each language has it's own simple web server), but often used for K8s ingress, etc.*
    - For CentOS 7, we use:
      - install "sudo yum install httpd"
    - start and stop; restart:
    - logs are located at /var/log/httpd/\*, use tail to review
      - tail -n20; tail -f error.log &
    - web server configuration under: /etc/apache2
      - sudo a2ensite; a2enmod
    - web docroot and home page: /var/www/html/index.html
    - More resources to learn Apache: TBD
  - Walkthrough/demo video of C2L4-Lab2:
    - TBD: Things to look out for to troubleshoot problems on each step?
    - add Web server install, web server start, web server stop, web server restart
    - Discuss: why do we skip web server uninstall?
  - EXERCISE/LAB C2L4-Lab2: Calm multi-VM blueprint web server Linux VM
    - Learn and walkthrough, repurposed from [*https://github.com/mlavi/calmbootcamp/blob/master/calm\_linux\_track/calm\_linux\_app/calm\_linux\_app.rst*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst):
          -   [*Creating a Blueprint*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#creating-a-blueprint)
          -   [*Creating Credentials*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#creating-credentials)
          -   [*Defining Variables*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#defining-variables) (skip on web server)
          -   [*Adding a Downloadable Image*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#adding-a-downloadable-image)
          - Use the [*Creating the Database Service*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#creating-the-database-service) skeleton with [*Creating the web server service*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#creating-the-web-server-service) detail
              a.  Create blueprint \$STUDENTID-web in your default student project
              b.  Create service1, rename to web 1, clone from environment, adjust properties
              c.  Save and troubleshoot any validation issues
              d.  Add install task
              e.  Save and troubleshoot any validation issues
              f.  Launch and Audit deployment
    -   Review exercise: you did your first push button automated web server lifecycle with a few clicks.
  - Quiz: a new employee asks for a web server. What is the best answer to give them a repeatable, delegatable web server?
        -   Insure external people or groups are in a new project, then Blueprint Publish, Approve, Add project(s) and Publish to Marketplace
        -   Publish a web server blueprint to the default project in the marketplace.
        -   Add people or groups to my project
        -   Add people to in directory server groups
        -   All of the above steps are required
        -   Any of the above steps will suffice (correct)
      -   Review answer
  - Concept: Lesson 4 Review: we learned to do TBD

5. Lesson 5: Calm automation for three tier web application with life cycle management
  - Concept: Learning objectives:
    1. Achieve self-service SaaS for a three tier web application based on LAMP stack
    2. Orchestrate the deployment and configuration of the database server with SQL, tasks, and macros.
    3. Add a custom action to change a database user password, publish and test the blueprint for PaaS self-service.
    4. Orchestrate the configuration of the load balancer with a web tier array using scale actions.
    5. Configure workload capacity choice with blueprint application profiles
    -   Add a database and load balancer to the blueprint to manage a three tier web application lifecycle and variable population
    -   Configure delegatable scale-in and scale-out actions on a web application tier with orchestrated changes to the load balancer.
    - Big Picture: intro, text summary, image, vocab, links/references
    - Developing your Inspiration:
    - Achieve self-service SaaS for life cycle action on a three tier web app blueprint
  - Concept: Calm Actions3
    - Calm can handle more complex PaaS and SaaS needs:
      - Additional Create stages: service pre-create and service package install
      - Additional Delete stages: service package uninstall and service post-delete.
      - Scale-in and Scale-out: to change a service tier array's population
      - Custom actions for ongoing maintenance and operations
  - Concept: Calm Orchestration Pill
    - Each application profile can use Calm macros for dynamic configuration inside actions and service properties.
    - Calm Macros will automatically create dependency arcs between services when saving a blueprint.
    - Logical service dependencies can be made with white arrows to order services.
    - References:
      - [Calm Glossary](../../../appendix/glossary.rst) when needed for students
      - [Documentation](https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Calm-Admin-Operations-Guide-v3_0%3Anuc-components-dependencies-overview-c.html)
  - Concept: PHP programming language pill (can be moved up to C2L4?)
    - A open-source, relatively easy to learn language, and database friendly drivers make it a good choice for the LAMP stack
    - Warning: all programming on the Internet must also encompasses security design, outside of this scope
    - For performance, we will install PHP for use inside the Apache web server.
    - For CentOS 7, we use:
      - install "sudo yum install php7"
    - start and stop; restart:
    - web server configuration under: /etc/apache2
      - sudo a2ensite; a2enmod
    - web docroot and home page: /var/www/html/index.php
    - More resources to learn PHP: TBD
  - Concept: Database Pill
    - Why MySQL/MariaDB: a leading relational database, the typical M in LAMP stack.
    - Databases manage collections of data with RBAC
    - Data is organized in tables accessed via SQL statements
    - clustering, transactions, replication, D/R, indexes, joins, and NoSQL databases are advanced design and management topics outside of this pill
    - Database install, start/stop, logs
  - Concept: SQL statement Pill, just enough to:
    - update the root user, create a web application user
    - create a table
    - grant privs on table
    - update a password on the web application user
  - LAB/EXERCISE: Add the database service:
      -   Walkthrough/demo: Refactor the monolith, reuse the tasks!
      -   Exercise:
          -   Complete the [*Creating the Database Service*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#creating-the-database-service) skeleton
          -   Delete the mysql tasks
          -   Add MySQL service and tasks to actions
          -   Wire logical dependency
          -   Save and launch to test
          -   Review
      -   Review
  - LAB/EXERCISE: Add a database password change custom action
    - Walkthrough steps
    - Exercise steps
    - Concept: Orchestration dependencies across services
      -   Walkthrough
      -   Exercise: [*Adding dependencies*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#adding-dependencies)
    - Concept: Load Balancer Pill
      - Load balancing allows us to remove pets for failure while also scaling out performance.
      - We will design the load balancer to distribute web requests across a web-tier of servers.
      - Why HAProxy? Opensource and very flexible.
      - Alternatives include F5, etc.
      - For CentOS 7, we use:
        - install "sudo yum install haproxy"
      - start and stop; restart:
      - logs are located at /var/log/\*, use tail to review
        - tail -n20; tail -f error.log &
      - configuration under: /etc/
      - More resources to learn HAProxy: http://www.haproxy.org/
    - Concept: Design the Load Balancer tier
      - Walkthrough/demo: Add the load balancer service
      - LAB/EXERCISE: Add the load balancer service
          - [*Creating the load balancer service*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_linux_app/calm_linux_app.rst#creating-the-load-balancer-service)
          - Add tasks to the library?
          - TBD: can they be pre-made, are they global or scoped to project?
    - Concept: Calm scale-in and scale-out web service
      - Walkthrough/demo:
        - add scale-in and scale-out web tier
        - add orchestrated task on load balancer server: update configuration
        - save blueprint and test
    - Exercise:
        -   Add web tier actions: scale in and scale out [*Scaling Out*](https://github.com/mlavi/calmbootcamp/blob/master/calm_linux_track/calm_day2_linux/calm_day2_linux.rst#scaling-out)
        -   Add load balancer task, orchestrate dependencies
        -   Test deployment by launching blueprint
        -   Post deployment action: scale out
        -   Audit: Observe web tier population +1
        -   Reload the load balancer to observe new node in rotation
        -   Post deployment action: scale in
        -   Audit: Observe web tier population -1
        -   Reload the load balancer to observe new node no longer in rotation
        -   Delete application
        -   Add web scale tasks to the Task Library from blueprint by cut and paste?
    -   Quiz: why is scalability important?
        -   Single point of failure
        -   How much time saved?
        -   TBD
        -   Review answer
    - Concept: Multiple application profiles
      - Walkthrough:
        - Rename default application profile to: Small (remember best practices)
        - Clone Small application profile, rename to Medium
        - Localize medium application profile services, change the VMs to:
          - DB = 2vCPU, 2GB RAM
          - Web = 2vCPU
      - Exercise
        - Reproduce the above.
  - Concept: Lesson 5 Review: we learned to test the deployment, scale the web tier in and out

6. Course 2 Review: Private Cloud Automation for self-service enterprise apps
7. Project 2
---
- Dropped: Lesson 6: Prism Central and Calm APIs for continuous ops?
- Course 3: Concept: hybrid
  - Hybrid Nutanix clusters for AWS, vs. others
  - We've focused on Linux for this nanodegree for speed, but Windows is an equal citizen.
  - Concept: Calm Actions and Tasks Pill2
      - Concept: HTTP Task Pill
      - Concept: Eval Task Pill
        - Eval can be a shell task, but expects a final output format, which will update a specified Calm macro.
      - Concept: Pause Task
        - A pause in seconds to accommodate for operations to complete.
  - Concept: Actions versus service actions
    - What happens when you clone an app profile, scope?
  - Concept: Blueprint optimization: operation/task dependencies
- AWS foundation: EC2+VPC
